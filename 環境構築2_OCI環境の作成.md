# OCI Cloud側ネットワーク環境構築手順

## 概要

本手順書では、Oracle Cloud Infrastructure（OCI）上にAzure ExpressRoute接続用のネットワーク環境を構築する手順について説明します。  <br>

<br>

以下のリソースを順番に作成します。

- 仮想クラウド・ネットワーク（VCN）
- サブネット（パブリック）
- コンピュート・インスタンス（Windows Server）
- セキュリティ・リスト
- ネットワーク・セキュリティ・グループ（NSG）
- 動的ルーティング・ゲートウェイ（DRG）
- Azure環境向けルート設定

---

## 仮想クラウドネットワークの作成

ホーム画面の左ペインより  「ネットワーキング」→「仮想クラウド・ネットワーク」を押下する<br>

![alt text](</img/スクリーンショット 2026-02-13 215150.png>)<br>

<br>

以下の通り設定して作成する。

| 項目 | 入力方法 |
|:---------|:---------|
| 名前 | ネットワーク名 |
| コンパートメントに作成 | デフォルト値 |
| IPv4 CIDRブロック | Azureと重複しないIP範囲 |

![alt text](</img/スクリーンショット 2026-02-13 215441.png>)<br>

<br>

---

## サブネットの作成

ネットワーク作成後に表示される画面で、「サブネット」タブ → 「サブネットの作成」を押下する。<br>

![alt text](</img/スクリーンショット 2026-02-13 215847.png>)<br>

<br>

以下の通り設定して作成する。

| 項目 | 入力方法 |
|:---------|:---------|
| 名前 | サブネット名 |
| コンパートメントに作成 | デフォルト値 |
| サブネットタイプ | リージョナル |
| IPv4 CIDRブロック | VCN内の必要なIP範囲 |
| サブネットアクセス | パブリック・サブネット（RDP接続を行うため） |
| その他 | デフォルト値 |

![alt text](</img/スクリーンショット 2026-02-13 220101.png>)<br>

<br>

---

## コンピュート・インスタンスの作成

ホーム画面の左ペインより  「コンピュート」→「インスタンス」を押下する。<br>

![alt text](</img/スクリーンショット 2026-02-13 212748.png>)<br>

<br>

### 基本情報タブ

以下の通り入力する。

| 項目 | 入力方法 |
|:---------|:---------|
| 名前 | インスタンス名 |
| コンパートメントに作成 | デフォルト値 |
| オペレーティング・システム | Windows Server 2022 Standard |

![alt text](</img/スクリーンショット 2026-02-13 213717.png>)<br>

<br>

### ネットワーキングタブ

以下の通り入力し、作成する。

| 項目 | 入力方法 |
|:---------|:---------|
| VNIC名 | 任意のVNIC名 |
| プライマリ・ネットワーク | 既存の仮想クラウド・ネットワーク |
| 仮想クラウド・ネットワーク | 作成したネットワークを選択 |
| サブネット | 作成したサブネット |

![alt text](</img/スクリーンショット 2026-02-13 220913.png>)<br>

<br>

作成したインスタンスの「インスタンスアクセス」より、ユーザー名と初期パスワードを控える。  <br>

![alt text](</img/スクリーンショット 2026-02-13 221441.png>)<br>

<br>

---

## セキュリティ・リストの設定

ネットワーク画面にて「セキュリティ」タブ → 「セキュリティ・リスト」を選択する。<br>

![alt text](</img/スクリーンショット 2026-02-13 222123.png>)<br>

<br>

イングレス・ルールにデフォルトで設定されている  `0.0.0.0/0` のTCP許可設定を編集する。<br>

![alt text](</img/スクリーンショット 2026-02-13 222347.png>)<br>

<br>

プロトコルを「すべてのプロトコル」に設定して保存する。<br>

![alt text](</img/スクリーンショット 2026-02-13 222606.png>)<br>

<br>

---

## ネットワーク・セキュリティ・グループ（NSG）の設定

ネットワーク画面にて、「セキュリティ」タブ → 「ネットワーク・セキュリティ・グループの作成」を押下する。<br>

![alt text](</img/スクリーンショット 2026-02-13 222123.png>)<br>

<br>

以下の通り、イングレスおよびエグレスのルールで  すべての通信を許可するルールを作成する。<br>

![alt text](</img/スクリーンショット 2026-02-13 223959.png>)<br>

<br>

作成したインスタンスに対して、パブリックIP・ユーザー名・初期パスワードを使用してローカルPCからRDP接続する。<br>

※初回ログイン時にパスワード変更を求められるため、変更すること。

<br>

---

## DRG（動的ルーティング・ゲートウェイ）の作成

ホーム画面の左ペインより  「ネットワーキング」→「動的ルーティング・ゲートウェイ」を押下する。<br>

![alt text](</img/スクリーンショット 2026-02-14 065333.png>)<br>

<br>

DRG作成画面にて、任意の名前を入力して作成する。<br>

<br>

作成したDRGの画面で、「仮想クラウド・ネットワーク・アタッチメントの作成」を押下する。<br>

![alt text](</img/スクリーンショット 2026-02-13 225234.png>)<br>

<br>

以下の通り入力して作成する。

| 項目 | 入力方法 |
|:---------|:---------|
| 名前 | 任意のアタッチメント名 |
| 仮想クラウド・ネットワーク | 作成したネットワークを選択 |
| その他 | デフォルト値 |

![alt text](</img/スクリーンショット 2026-02-13 225432.png>)<br>

<br>

---

## Azure環境へのルーティング設定

ネットワーク画面にて、「ルーティング」タブ → デフォルトのルート表を選択する。<br>

![alt text](</img/スクリーンショット 2026-02-13 225807.png>)<br>

<br>

「ルート・ルールの追加」を押下する。<br>

![alt text](</img/スクリーンショット 2026-02-13 225952.png>)<br>

<br>

Azure側のIPアドレス範囲宛の通信が、  作成したDRGをネクストホップとするよう設定して作成する。<br>

![alt text](</img/スクリーンショット 2026-02-13 230428.png>)<br>

<br>
